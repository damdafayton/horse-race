(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{57:function(e,t,n){e.exports={container:"WinnerModal_container__260aH",gif:"WinnerModal_gif__3mnTx"}},58:function(e,t,n){e.exports={horses:"Horses_horses__1rnSf",rotateHorse:"Horses_rotateHorse__XBJ_V",names:"Horses_names__313sw",gif:"Horses_gif__1qRC0"}},88:function(e,t,n){},89:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a,c=n(0),s=n.n(c),r=n(40),i=n.n(r),o=n(14),d=n(7),l=n(1),u=n(55),h=n(64),f=n(66),j=n(16),m=n(71),b="https://horse-racing-server.herokuapp.com/",O={API_URL:b,API_ENDPOINT_FOR_REDUX:"api",API_URL_FOR_SOCKET:b,SOCKET_MESSAGE_FOR_HORSES:"ticker",MAX_DISTANCE:1e3},x=O.API_URL,p=O.SOCKET_MESSAGE_FOR_HORSES,_=O.API_ENDPOINT_FOR_REDUX,g=O.API_URL_FOR_SOCKET,R=Object(f.a)({reducerPath:"dataApi",baseQuery:Object(j.d)({baseUrl:x}),endpoints:function(e){return{raceData:e.query({query:function(){return _},onCacheEntryAdded:function(e,t){return Object(h.a)(Object(u.a)().mark((function e(){var n,a,c,s;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.updateCachedData,a=t.cacheDataLoaded,c=t.cacheEntryRemoved,console.log("Making request for the first time in a while"),e.prev=2,e.next=5,a;case 5:s=Object(m.a)(g),console.log("connected"),s.on("connect",(function(e){s.emit("start"),console.log({connectMessage:e})})),s.on(p,(function(e){n((function(t){t.push(e)}))})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log({error:e.t0});case 14:return e.next=16,c;case 16:s.off(),console.log("No component subscribed to the data for a while");case 18:case"end":return e.stop()}}),e,null,[[2,11]])})))()}})}}}),N=R.useRaceDataQuery,E={maxWidth:15,isRaceEnded:!1,latestRaceData:void 0,winner:void 0},v=Object(l.d)({name:"horses",initialState:E,reducers:{updateLatestRaceData:function(e,t){e.latestRaceData=t.payload},zoomIn:function(e){e.maxWidth+=1},zoomOut:function(e){e.maxWidth-=1},endTheRace:function(e){e.isRaceEnded=!0},setWinner:function(e,t){e.winner=t.payload}}}),y=v.actions,w=y.updateLatestRaceData,S=y.zoomIn,A=y.zoomOut,D=y.endTheRace,I=y.setWinner,C=v.reducer,H=Object(l.a)({reducer:(a={},Object(d.a)(a,R.reducerPath,R.reducer),Object(d.a)(a,"horses",C),a),middleware:function(e){return e({serializableCheck:{ignoredActions:["horses/setSocket"],ignoredPaths:["horses.socket"]}}).concat(R.middleware)}}),k=(n(88),n(89),n(24)),P=n(69),T=n.n(P),W=n(70),M=n.n(W),L=n(68),U=n.n(L),F=n(67),z=n.n(F),X=n(57),q=n.n(X),K=n(3);function G(){var e=Object(k.d)((function(e){return e.horses})).winner;return e&&Object(K.jsx)("section",{className:q.a.container,children:Object(K.jsxs)("div",{className:"pt-5 mt-3 d-flex flex-column align-items-center",children:[Object(K.jsx)("h1",{className:"fs-4 text-center text-primary",children:"WINNER"}),Object(K.jsx)("h1",{className:"mb-5 mt-2 text-center",children:e.name.toUpperCase()}),Object(K.jsx)("img",{alt:"winner",className:q.a.gif,src:e.gif})]})})}var J=n(35),B=n(15),Q=n(58),V=n.n(Q),Y=n.p+"static/media/l1.8ba713ae.gif",Z=n.p+"static/media/l2.826e2d8e.gif",$=n.p+"static/media/l_miracle.dfb40033.gif",ee=n.p+"static/media/r1.662feb6e.gif",te=n.p+"static/media/r2.3a353552.gif",ne=n.p+"static/media/r3.7a54ba2a.gif",ae=O.MAX_DISTANCE;function ce(){var e=N().data,t=Object(k.d)((function(e){return e.horses})),n=t.maxWidth,a=t.latestRaceData,s=t.isRaceEnded,r=Object(k.c)(),i=[{gif:Y,style:"rotateHorse"},{gif:Z,style:"rotateHorse"},{gif:$,style:"rotateHorse"},{gif:ee,style:"horses"},{gif:te,style:"horses"},{gif:ne,style:"horses"}];return Object(c.useEffect)((function(){if(console.log({data:e}),!s&&e&&e.length){var t=e[e.length-1],n=t.filter((function(e){return e.distance>=ae})),a=Object(B.a)(n,1)[0];if(a)return a=Object(J.a)(Object(J.a)({},a),i[t.indexOf(a)]),r(D()),void r(I(a));r(w(t))}}),[e]),Object(K.jsx)("section",{className:"mb-3",children:Object(K.jsx)("div",{className:"d-flex flex-column text-start",children:a&&a.map((function(e,t){return Object(K.jsxs)("div",{children:[Object(K.jsx)("h2",{className:V.a.names,children:e.name}),Object(K.jsx)("img",{alt:"horse",src:i[t].gif,style:{maxWidth:"".concat(n,"vw"),marginLeft:"".concat((100-n)*e.distance/ae-2,"vw")},className:V.a[i[t].style]})]},"".concat(e.name))}))})})}var se=function(){var e=Object(k.c)(),t=Object(k.d)((function(e){return e.horses})).winner,n=U()(),a=n.width,c=n.height;return Object(K.jsxs)("div",{className:"App",children:[Object(K.jsxs)("header",{className:"App-header py-2 position-relative mb-3 px-4",children:[Object(K.jsx)("h1",{className:"fs-5",children:"HORSE RACING"}),Object(K.jsxs)("span",{className:"position-absolute end-0 gap-2 ",children:[Object(K.jsx)("button",{type:"button",className:"btn-clean text-white me-3",onClick:function(){return e(S())},children:Object(K.jsx)(T.a,{className:"h-2rem"})}),Object(K.jsx)("button",{type:"button",className:"btn-clean text-white me-4",onClick:function(){return e(A())},children:Object(K.jsx)(M.a,{className:"h-2rem"})})]})]}),Object(K.jsx)("main",{children:Object(K.jsx)(ce,{})}),t&&Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(z.a,{width:a-30,height:c}),Object(K.jsx)(G,{})]})]})};i.a.render(Object(K.jsx)(s.a.StrictMode,{children:Object(K.jsx)(o.a,{store:H,children:Object(K.jsx)(se,{})})}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.71d6f683.chunk.js.map